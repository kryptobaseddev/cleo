---
title: "Skill Dispatch Algorithm"
description: "Automatic skill selection based on task type, keywords, labels, and categories"
---

# Skill Dispatch Algorithm

**Version**: 1.0.0 | **Status**: ACTIVE

The dispatch algorithm automatically selects the appropriate skill for a task based on multiple matching strategies.

## Decision Tree

```
Task Input
    │
    ▼
┌─────────────────────────────────────┐
│ 1. Category Override Check          │
│    task.category set?               │
│    → skill_dispatch_by_category()   │
└─────────────────────────────────────┘
    │ No match
    ▼
┌─────────────────────────────────────┐
│ 2. Task Type Match                  │
│    dispatch_matrix.by_task_type     │
│    task.type → skill mapping        │
└─────────────────────────────────────┘
    │ No match
    ▼
┌─────────────────────────────────────┐
│ 3. Keyword Pattern Match            │
│    dispatch_matrix.by_keyword       │
│    title + description → regex      │
└─────────────────────────────────────┘
    │ No match
    ▼
┌─────────────────────────────────────┐
│ 4. Label-based Match                │
│    task.labels → category mapping   │
└─────────────────────────────────────┘
    │ No match
    ▼
┌─────────────────────────────────────┐
│ 5. Default Fallback                 │
│    → ct-task-executor               │
└─────────────────────────────────────┘
```

## Strategy Details

### 1. Category Override (Priority 1)

If task has explicit `.category` field set:

```bash
skill_dispatch_by_category("documentation")
# Returns: ct-documentor
```

**Category Mappings** (from `lib/skill-dispatch.sh`):

| Category | Skill |
|----------|-------|
| `orchestration` | ct-orchestrator |
| `research` | ct-research-agent |
| `design` | ct-epic-architect |
| `implementation` | ct-task-executor |
| `testing` | ct-test-writer-bats |
| `documentation` | ct-documentor |
| `validation` | ct-validator |
| `specification` | ct-spec-writer |

### 2. Task Type Match (Priority 2)

From `manifest.json` dispatch_matrix:

```json
{
  "dispatch_matrix": {
    "by_task_type": {
      "research": "ct-research-agent",
      "planning": "ct-epic-architect",
      "implementation": "ct-task-executor",
      "testing": "ct-test-writer-bats",
      "documentation": "ct-documentor"
    }
  }
}
```

### 3. Keyword Pattern Match (Priority 3)

Regex patterns matched against task title + description:

```json
{
  "by_keyword": {
    "epic|plan|decompose|architect": "ct-epic-architect",
    "research|investigate|explore|analyze": "ct-research-agent",
    "test|spec|bats|unit test": "ct-test-writer-bats",
    "document|docs|readme|guide": "ct-documentor",
    "validate|verify|check|audit": "ct-validator"
  }
}
```

### 4. Label-based Match (Priority 4)

Task labels mapped to categories:

| Label | Category | Skill |
|-------|----------|-------|
| `research` | research | ct-research-agent |
| `epic` | design | ct-epic-architect |
| `testing` | testing | ct-test-writer-bats |
| `documentation` | documentation | ct-documentor |
| `bug` | implementation | ct-task-executor |

### 5. Default Fallback

If no match found: `ct-task-executor`

## Usage

### Automatic Dispatch

```bash
# Get recommended skill for task
cleo orchestrator next --epic T001
# Returns task with recommended skill

# Spawn with auto-selected skill
cleo orchestrator spawn T1234
# Automatically selects skill based on dispatch algorithm
```

### Manual Override

```bash
# Force specific skill
cleo orchestrator spawn T1234 --skill ct-research-agent
```

## Debugging

Enable debug output:

```bash
export SKILL_DISPATCH_DEBUG=1
cleo orchestrator spawn T1234
```

Debug output shows:
- Input task metadata
- Each strategy attempted
- Match/no-match result
- Final skill selected

## Exit Codes

| Code | Meaning |
|------|---------|
| 0 | Skill selected successfully |
| 1 | No matching skill (uses default) |
| 4 | Task not found |
| 6 | Validation error |

## Related

- [Protocol Injection Flow](./PROTOCOL-INJECTION-FLOW.md)
- [Skill Development Guide](./skill-development.md)
- [Manifest Schema](./MANIFEST-SCHEMA.md)
